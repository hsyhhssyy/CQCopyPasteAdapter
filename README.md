# Ctrl+C/Ctrl+V Adapter

该项目旨在通过Ctrl+C Ctrl+V的方式调用QQ桌面版来发送消息。
该Adapter只能用来发送消息。
该Adapter是用来配合AmiyaBot的amiyabot-message-send-kidnapper插件的，但是你也可以自行实现一个WebService来配合他。

## 如何使用

1. 从Release页面下载软件的程序包，并以管理员身份打开CQCopyPasteAdapter.exe。可能需要你安装.Net，请根据弹出的提示下载安装或从下面链接下载安装。

|  内容   | 下载地址  |
|  ----  | ----  |
| Adapter软件包 | [Release](https://github.com/hsyhhssyy/CQCopyPasteAdapter/releases/) |
| .Net Client Profile | [.Net](https://dotnet.microsoft.com/zh-cn/download) |

2. 启动Windows桌面版QQ，并登录Bot账户，然后打开每一个群的窗口。注意不要使用标签页的形式打开窗口，而是每个群聊单独一个窗口。

3. 切换到软件的“窗口”标签页，点击“添加频道”按钮，并输入ChannelId（对于QQ群来说，就是群号）。有些临时拉的群通过WindowsQQ无法查看群号，但是他们也有群号，你可以去Mirai或者CQ的日志里查看。

4. 添加了群号以后，点击页面表格的“操作”栏的按钮，打开“选择句柄”窗口。

5. 按下“获取窗口句柄”按钮后，下面会出现一个3秒的倒计时，请在3秒内切换到该群对应的QQ窗口并将光标放在消息输入框中。倒计时结束后窗口会自动关闭，窗体句柄和标题会被自动填入软件，请在表格中检查标题是否正确。

6. 重复上述操作，将所有频道都添加进表格中。

7. 切换到“设置”标签页，然后在里面双击Value单元格来修改服务器地址和密钥。这两项内容和你在AmiyaBotConsole连接时填写的内容一致。最后一步做这个，是防止Bot在你操作的时候说话，导致键鼠被控制影响你的操作。

8. 现在，你可以触发bot说一句话，看看是否有问题。

## FAQ

1. 我用了一阵你的Adapter之后，bot突然不能说话了，之前还好好的。

你的窗口句柄是否发生了变化？如果发生了变化，需要你重新点击页面表格的“操作”栏的按钮，重新获取句柄。一般来说，只要你关闭了QQ窗口，或者某几个QQ窗口合并了标签页（哪怕之后再拆分），窗口句柄都会发生变化。

软件每隔20秒会检查一下所有句柄的有效性，你可以通过观察表格中窗口标题是否正确来判断。

2. 用了你这个Adapter以后，我电脑就没法使用了，他老是控制我的键鼠，切换我的窗口。

是的，这个Adapter就是这样，建议你使用虚拟机或者云服务器来运行该软件。

3. 为什么每次配置好以后过一会儿就会失效？

请检查你的winodws是否有超时关闭显示器，锁定或者睡眠的设置。

4. 我能用远程桌面来管理我的服务器吗？

不能！远程桌面连接有一个问题，那就是当远程桌面连接断开时，服务器桌面会被锁定。因此每当你通过远程桌面连接控制过一次服务器后，当你退出时，Adapter就失效了，你需要通过VMC/VNC等虚拟机/云主机直接控制手段解锁系统才可恢复。

5. 其他奇奇怪怪的问题

遇到上面没有提到的问题，请你在下方链接提交反馈。

> [遇到问题可以在这里反馈(Github)](https://github.com/hsyhhssyy/CQCopyPasteAdapter/issues/new/)

## 鸣谢

感谢兔妈和ChatGPT在本项目开发中提供的友情支持。

> [项目地址:Github](https://github.com/hsyhhssyy/CQCopyPasteAdapter/)

|  版本   | 变更  |
|  ----  | ----  |
| 1.0.0  | 初始版本 |